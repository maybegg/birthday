<!docType html>
<html>
<head>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />

    <title>微信接口测试</title>

    <script>

        if(document.addEventListener){
            document.addEventListener('WeixinJSBridgeReady', sendMessage, false);
        }else if(document.attachEvent){
            document.attachEvent('WeixinJSBridgeReady' , sendMessage);
            document.attachEvent('onWeixinJSBridgeReady' , sendMessage);
        }



        // 所有功能必须包含在 WeixinApi.ready 中进行
       function sendMessage(Api){

            // 微信分享的数据
            var wxData = {
                "imgUrl":'http://www.baidufe.com/fe/blog/static/img/weixin-qrcode-2.jpg',
                "link":'http://www.baidufe.com',
                "desc":'大家好，我是Alien，Web前端&Android客户端码农，喜欢技术上的瞎倒腾！欢迎多交流',
                "title":"大家好，我是赵先烈"
            };

            // 分享的回调
            var wxCallbacks = {
                // 分享操作开始之前
                ready:function () {
                    // 你可以在这里对分享的数据进行重组
                },
                // 分享被用户自动取消
                cancel:function (resp) {
                    alert(1);
                    // 你可以在你的页面上给用户一个小Tip，为什么要取消呢？
                },
                // 分享失败了
                fail:function (resp) {
                    // 分享失败了，是不是可以告诉用户：不要紧，可能是网络问题，一会儿再试试？
                },
                // 分享成功
                confirm:function (resp) {
                    // 分享成功了，我们是不是可以做一些分享统计呢？
                },
                // 整个分享过程结束
                all:function (resp) {
                    // 如果你做的是一个鼓励用户进行分享的产品，在这里是不是可以给用户一些反馈了？
                }
            };

           WeixinJSBridge.on('menu:share:appmessage', function(argv){
               WeixinJSBridge.invoke('sendAppMessage',{

                   "appid":"123", //appid 设置空就好了。
                   "img_url":"https://opas-file.b0.upaiyun.com/image/20160818/c8e9856797c3a6cc99cdab7070c77d10.png", //分享时所带的图片路径
                   "img_width":"120", //图片宽度
                   "img_height":"120", //图片高度
                   "link":"http://www.3lian.net", //分享附带链接地址
                   "desc":"极客标签--http://www.jb51.net", //分享内容介绍
                   "title":"发现 极客标签 - 做最棒的极客知识分享平台"
               }, function(res){/*** 回调函数，最好设置为空 ***/

               });
           });

            // 用户点开右上角popup菜单后，点击分享给好友，会执行下面这个代码
        //    Api.shareToFriend(wxData, wxCallbacks);

            // 点击分享到朋友圈，会执行下面这个代码
         //   Api.shareToTimeline(wxData, wxCallbacks);

            // 点击分享到腾讯微博，会执行下面这个代码
         //   Api.shareToWeibo(wxData, wxCallbacks);
        };
        // function sendMessage(){
        //     WeixinJSBridge.on('menu:share:appmessage', function(argv){
        //         WeixinJSBridge.invoke('sendAppMessage',{
        //
        //             "appid":"123", //appid 设置空就好了。
        //             "img_url":"https://opas-file.b0.upaiyun.com/image/20160818/c8e9856797c3a6cc99cdab7070c77d10.png", //分享时所带的图片路径
        //             "img_width":"120", //图片宽度
        //             "img_height":"120", //图片高度
        //             "link":"http://www.3lian.net", //分享附带链接地址
        //             "desc":"极客标签--http://www.jb51.net", //分享内容介绍
        //             "title":"发现 极客标签 - 做最棒的极客知识分享平台"
        //         }, function(res){/*** 回调函数，最好设置为空 ***/
        //
        //         });
        //     });
        //
        //     WeixinJSBridge.on('menu:share:timeline', function(argv){
        //
        //         WeixinJSBridge.invoke('shareTimeline',{
        //
        //             "appid":"123", //appid 设置空就好了。
        //             "img_url":"https://opas-file.b0.upaiyun.com/image/20160818/c8e9856797c3a6cc99cdab7070c77d10.png", //分享时所带的图片路径
        //             "img_width":"120", //图片宽度
        //             "img_height":"120", //图片高度
        //             "link":"http://www.3lian.net", //分享附带链接地址
        //             "desc":"极客标签--http://www.jb51.net", //分享内容介绍
        //             "title":"发现 极客标签 - 做最棒的极客知识分享平台"
        //         }, function(res){/*** 回调函数，最好设置为空 ***/
        //         });
        //
        //     });
        //
        //
        //     alert("调用成功！现在可以通过右上角按钮分享给朋友或者朋友圈！");
        //
        // }
        //
        // function hideMenu(){
        //     WeixinJSBridge.call('hideOptionMenu');
        // }
        //
        // function showMenu(){
        //     WeixinJSBridge.call('showOptionMenu');
        // }
        //
        // function hideTool(){
        //     WeixinJSBridge.call('hideToolbar');
        // }
        //
        // function showTool(){
        //     WeixinJSBridge.call('showToolbar');
        // }
        //

        //
        // //判断网页是否在微信中被调用
        // var ua = navigator.userAgent.toLowerCase();
        // if(ua.match(/MicroMessenger/i)=="micromessenger") {
        // } else {
        //     alert("调用失败，请用微信扫一扫，扫描下面二维码打开网页！");
        // }

    </script>

</head>

<body>
<center>
    <h2>分享请点击右上角</h2>
    <button onclick="hideMenu()" style="width:100px;height:100px;font-size:16px;">隐藏右上角三个点</button&gt; <br /><br />
    <button onclick="showMenu()" style="width:100px;height:100px;font-size:16px;">显示右上角三个点</button&gt; <br /><br />
    <button onclick="hideTool()" style="width:100px;height:100px;font-size:16px;">隐藏下面导条</button&gt; <br /><br />
    <button onclick="showTool()" style="width:100px;height:100px;font-size:16px;">显示下面导条</button&gt; <br /><br />
</center>
</body>

</html>

